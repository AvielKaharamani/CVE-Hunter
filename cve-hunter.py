import argparse
import logging
from cve_finder import CveFinder
from helper import Helper


def main():
    parser = argparse.ArgumentParser(description='Search CVEs in a requirements.txt file')
    parser.add_argument('-r', '--requirements', metavar='<path-to-requirements.txt>', required=True,
                        help='path to requirements.txt file')

    args = parser.parse_args()

    logging.basicConfig(
        level=logging.ERROR,
        format='%(asctime)s %(levelname)-8s %(message)s',
        datefmt='%Y-%m-%d %H:%M:%S',
        filename='cve_hunter.log',
        filemode='w')

    requirements_file = args.requirements
    cve_finder = CveFinder()

    cve_result = cve_finder.search_cves(requirements_file)
    Helper.print_result_table(cve_result)


if __name__ == '__main__':
    main()
